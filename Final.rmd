---
title: "Covid91 vaccine study Final2024"
author: "Peter Dang"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="finalSumr2024.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

## Males

Is the vaccine effective in males?

The null hypothesis: the new preventive vaccine (Covid921) doesn't exhibit any effectiveness on males

The alternative hypothesis: Covid921 does exhibit effectiveness on males.

Cat~Cat

```{r}
Males = FinalData[FinalData$sex=='M',]
head(Males)
```

## Graphical results for males 

```{r}
barchartGC(~infected + treatment,data=Males)
barchartGC(~infected + treatment,data=Males, type="percent")
```

According to the graphical results, The graph shows that the vaccine is effective in preventing COVID in males, because the amount of  males who got the vaccine and contracted COVID was lower than the men who got the placebo. 

## Numerical results for males 

```{r}
table1 <- xtabs(~infected + treatment, data=Males)
rowPerc(table1)
colPerc(table1)
```

According to the data, we can see that 26.20% of men got the vaccine and contracted COVID, while 73.80% of them got the placebo and contracted COVID. 

## Inferential results for males 

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

Based on the inferential results, the p-value from the chi-squared test is 0.00000000000000022, which means this is less than 0.05, therefore, we reject the null hypothesis. The odds ratio from the fisher's exact test was 2.815. This means that the vaccine has a 2.8 chance of being effective in males. 

## Females

Null hypothesis: Covid921 vaccine doesn't exhibit its effectiveness on females. 

Alternative hypothesis: Covid921 vaccine does exhibit its effectiveness on females. 

```{r}
Females = FinalData[FinalData$sex=='F',]
head(Females)
```

## Graphical results for females 

```{r}
barchartGC(~infected + treatment,data=Females)
barchartGC(~infected + treatment,data=Females, type="percent")
```

According to the graph, we can see that it shows that the vaccine is effective in women who got COVID compared to women who got the placebo. 

## Numerical results for females 

```{r}
table1 <- xtabs(~infected + treatment, data=Females)
rowPerc(table1)
colPerc(table1)
```

We can see that about 35.07% of females who got the vaccine contracted COVID. While 64.93% of females who got the placebo contracted COVID. This implies that the vaccine is effective in preventing COVID for women.

## Inferential results for females 

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

According to the inferential results, we can see that the p-value from the chi-squared test is less than 0.05, therefore we reject the null hypothesis. For the odds ratio in the fisher's exact test is 1.856, meaning that that there is approximately a 1.86 chance that the vaccine will be effective in females. 


## LGBTQ

Null hypothesis: the vaccine doesn't exhibit its effectiveness on people who are LGBTQ.

Alternative hypothesis: the vaccine does exhibit its effectiveness on people who are LGBTQ.

```{r}
gay = FinalData[FinalData$LGBTQ=='gay',]
head(gay)
```


## Graphical results 

```{r}
barchartGC(~infected + treatment,data=gay)
barchartGC(~infected + treatment,data=gay, type="percent")
```

There is about 20% of people who are LGBTQ who got COVID and received the vaccine. This is lower than the amount of LGBTQ people who got COVID and received the placebo. The vaccine is effective in stopping COVID in people who are LGBTQ.  

## Druggies


# Overall Results and Conclusions